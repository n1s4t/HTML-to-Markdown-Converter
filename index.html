<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Ultimate Markdown & HTML Converter</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://unpkg.com/turndown/dist/turndown.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/showdown/2.1.0/showdown.min.js"></script>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@tailwindcss/typography@0.5.x/dist/typography.min.css"/>

    <style>
        body {
            font-family: 'Inter', sans-serif;
        }
        textarea {
            font-family: 'Menlo', 'Monaco', 'Courier New', monospace;
            resize: none;
            border-width: 2px;
        }
        .source-pane {
            border-color: #4f46e5; /* Indigo-600 */
            box-shadow: 0 0 0 2px #a5b4fc; /* Indigo-300 */
        }
        .preview-pane {
            height: calc(100vh - 200px);
        }
        @media (max-width: 768px) {
            .preview-pane {
                height: 400px;
            }
        }
        /* Simple toggle switch styles */
        .toggle-checkbox:checked {
            right: 0;
            border-color: #10B981;
        }
        .toggle-checkbox:checked + .toggle-label {
            background-color: #10B981;
        }
    </style>
</head>
<body class="bg-gray-100 dark:bg-gray-900 text-gray-900 dark:text-gray-100">

    <div class="container mx-auto px-4 py-6">
        <!-- Header -->
        <header class="text-center mb-6">
            <h1 class="text-3xl md:text-4xl font-bold text-gray-800 dark:text-white">Ultimate Markdown & HTML Converter</h1>
            <p class="text-md text-gray-600 dark:text-gray-400 mt-2">A bi-directional converter with a live rendered preview.</p>
        </header>

        <!-- Controls -->
        <div class="flex flex-col md:flex-row justify-center items-center gap-4 mb-4 p-4 bg-white dark:bg-gray-800 rounded-xl shadow-md">
            <!-- Toggle Switch -->
            <div class="flex items-center space-x-4">
                <span class="font-semibold text-gray-700 dark:text-gray-300">HTML to Markdown</span>
                <div class="relative inline-block w-12 mr-2 align-middle select-none transition duration-200 ease-in">
                    <input type="checkbox" name="toggle" id="directionToggle" class="toggle-checkbox absolute block w-6 h-6 rounded-full bg-white border-4 appearance-none cursor-pointer"/>
                    <label for="directionToggle" class="toggle-label block overflow-hidden h-6 rounded-full bg-gray-300 dark:bg-gray-600 cursor-pointer"></label>
                </div>
                <span class="font-semibold text-gray-700 dark:text-gray-300">Markdown to HTML</span>
            </div>
             <!-- Action Buttons -->
            <div class="flex items-center space-x-3">
                 <button id="copyBtn" class="bg-green-500 hover:bg-green-600 text-white font-bold py-2 px-4 rounded-lg transition-transform transform hover:scale-105">Copy Output</button>
                 <button id="clearBtn" class="bg-red-500 hover:bg-red-600 text-white font-bold py-2 px-4 rounded-lg transition-transform transform hover:scale-105">Clear All</button>
            </div>
        </div>

        <!-- Main Converter Panels -->
        <main class="grid grid-cols-1 md:grid-cols-3 gap-4">
            <!-- HTML Panel -->
            <div>
                <label for="htmlPane" id="htmlLabel" class="block text-sm font-semibold mb-2">HTML Source</label>
                <textarea id="htmlPane" class="w-full h-full min-h-[400px] p-3 bg-white dark:bg-gray-800 border-gray-300 dark:border-gray-600 rounded-lg focus:outline-none transition-shadow duration-200"></textarea>
            </div>
            <!-- Markdown Panel -->
            <div>
                <label for="markdownPane" id="markdownLabel" class="block text-sm font-semibold mb-2">Markdown Output</label>
                <textarea id="markdownPane" class="w-full h-full min-h-[400px] p-3 bg-white dark:bg-gray-800 border-gray-300 dark:border-gray-600 rounded-lg focus:outline-none transition-shadow duration-200"></textarea>
            </div>
            <!-- Preview Panel -->
            <div>
                 <label for="previewPane" class="block text-sm font-semibold mb-2">Live Preview</label>
                <div id="previewPane" class="prose dark:prose-invert max-w-none w-full h-full min-h-[400px] p-3 bg-white dark:bg-gray-800 border-2 border-gray-300 dark:border-gray-600 rounded-lg overflow-auto"></div>
            </div>
        </main>
    </div>

    <!-- Toast Notification -->
    <div id="toast" class="fixed bottom-10 right-10 bg-gray-900 text-white py-3 px-6 rounded-lg shadow-lg opacity-0 transform translate-y-4 transition-all duration-300 ease-in-out">
        Copied to clipboard!
    </div>

    <script>
        document.addEventListener('DOMContentLoaded', () => {
            // DOM Elements
            const htmlPane = document.getElementById('htmlPane');
            const markdownPane = document.getElementById('markdownPane');
            const previewPane = document.getElementById('previewPane');
            const directionToggle = document.getElementById('directionToggle');
            const htmlLabel = document.getElementById('htmlLabel');
            const markdownLabel = document.getElementById('markdownLabel');
            const copyBtn = document.getElementById('copyBtn');
            const clearBtn = document.getElementById('clearBtn');
            const toast = document.getElementById('toast');

            // Converters
            const turndownService = new TurndownService({ headingStyle: 'atx', codeBlockStyle: 'fenced' });
            const showdownConverter = new showdown.Converter();
            
            // State
            let mode = 'htmlToMd'; // 'htmlToMd' or 'mdToHtml'

            const updatePanes = () => {
                if (mode === 'htmlToMd') {
                    const htmlInput = htmlPane.value;
                    try {
                        const markdownResult = turndownService.turndown(htmlInput);
                        markdownPane.value = markdownResult;
                        previewPane.innerHTML = showdownConverter.makeHtml(markdownResult);
                    } catch (e) {
                        markdownPane.value = "Error converting HTML.";
                    }
                } else { // mdToHtml
                    const markdownInput = markdownPane.value;
                    try {
                        const htmlResult = showdownConverter.makeHtml(markdownInput);
                        htmlPane.value = htmlResult;
                        previewPane.innerHTML = htmlResult;
                    } catch (e) {
                        htmlPane.value = "Error converting Markdown.";
                    }
                }
            };
            
            const setMode = (newMode) => {
                mode = newMode;
                if (mode === 'htmlToMd') {
                    directionToggle.checked = false;
                    htmlPane.readOnly = false;
                    markdownPane.readOnly = true;
                    htmlPane.classList.add('source-pane');
                    markdownPane.classList.remove('source-pane');
                    htmlLabel.textContent = 'HTML Source';
                    markdownLabel.textContent = 'Markdown Output';
                } else { // mdToHtml
                    directionToggle.checked = true;
                    htmlPane.readOnly = true;
                    markdownPane.readOnly = false;
                    htmlPane.classList.remove('source-pane');
                    markdownPane.classList.add('source-pane');
                    htmlLabel.textContent = 'HTML Output';
                    markdownLabel.textContent = 'Markdown Source';
                }
                updatePanes();
            };

            // Event Listeners
            directionToggle.addEventListener('change', () => {
                setMode(directionToggle.checked ? 'mdToHtml' : 'htmlToMd');
            });
            
            htmlPane.addEventListener('input', () => {
                if (mode === 'htmlToMd') updatePanes();
            });

            markdownPane.addEventListener('input', () => {
                if (mode === 'mdToHtml') updatePanes();
            });

            copyBtn.addEventListener('click', () => {
                const outputPane = mode === 'htmlToMd' ? markdownPane : htmlPane;
                if (outputPane.value) {
                    navigator.clipboard.writeText(outputPane.value).then(() => {
                        showToast();
                    }).catch(err => console.error('Failed to copy:', err));
                }
            });

            clearBtn.addEventListener('click', () => {
                htmlPane.value = '';
                markdownPane.value = '';
                previewPane.innerHTML = '';
            });

            function showToast() {
                toast.classList.remove('opacity-0', 'translate-y-4');
                toast.classList.add('opacity-100', 'translate-y-0');
                setTimeout(() => {
                    toast.classList.remove('opacity-100', 'translate-y-0');
                    toast.classList.add('opacity-0', 'translate-y-4');
                }, 2000);
            }

            // Initial Setup
            htmlPane.value = `<h1>Welcome!</h1>
<p>This is a <strong>bi-directional</strong> converter.</p>
<ul>
    <li>Use the toggle to switch directions.</li>
    <li>Edit the source pane (in blue).</li>
    <li>See the output and a live preview instantly!</li>
</ul>`;
            setMode('htmlToMd');
        });
    </script>
</body>
</html>


